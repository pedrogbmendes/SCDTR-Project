%% SESSION 3 

rate = [46.00
82.00
112.00
139.00
163.00
186.00
206.00
224.00
242.00
258.00
273.00
285.00
301.00
312.00
326.00
336.00
348.00
357.00
368.00
377.00
386.00
395.00
409.00
411.00
422.00
427.00
431.00
441.00
445.00
454.00
459.00
466.00
471.00
477.00
482.00
494.00
493.00
503.00
504.00
505.00
513.00
515.00
522.00
525.00
530.00
533.00
539.00
542.00
553.00
550.00
559.00
557.00
565.00
565.00
565.00
571.00
572.00
577.00
579.00
583.00
585.00
596.00
592.00
601.00
598.00
605.00
603.00
609.00
608.00
608.00
613.00
613.00
618.00
619.00
630.00
624.00
633.00
629.00
637.00
634.00
640.00
638.00
637.00
642.00
641.00
646.00
646.00
657.00
650.00
660.00
655.00
663.00
658.00
665.00
662.00
668.00
666.00
664.00
669.00
668.00
680.00
672.00
682.00
676.00
684.00
679.00
687.00
683.00
689.00
686.00
691.00
689.00
687.00
698.00
690.00
700.00
693.00
703.00
696.00
704.00
700.00
706.00
702.00
708.00
705.00
710.00
715.00
706.00
717.00
709.00
718.00
712.00
720.00
714.00
722.00
717.00
723.00
719.00
725.00
729.00
719.00
730.00
722.00
732.00
724.00
733.00
727.00
735.00
729.00
736.00
732.00
738.00
741.00
739.00
742.00
733.00
744.00
736.00
745.00
738.00
746.00
740.00
748.00
743.00
749.00
752.00
751.00
753.00
750.00
754.00
746.00
755.00
748.00
756.00
750.00
758.00
752.00
759.00
762.00
761.00
763.00
761.00
764.00
755.00
765.00
757.00
766.00
758.00
767.00
761.00
768.00
771.00
769.00
771.00
770.00
772.00
771.00
773.00
764.00
774.00
766.00
775.00
769.00
776.00
778.00
777.00
779.00
779.00
780.00
779.00
780.00
773.00
781.00
773.00
782.00
777.00
783.00
785.00
784.00
785.00
786.00
786.00
786.00
787.00
787.00
788.00
780.00
789.00
783.00
790.00
791.00
791.00
792.00
792.00
793.00
793.00
793.00
793.00
794.00
794.00
795.00
788.00
796.00
797.00
797.00
798.00
798.00
798.00
799.00
799.00
799.00
800.00
800.00
801.00
801.00
801.00
];

u = (0:1:255);

v = rate * 5 / 1023;

  m = -0.62;
  b = 4.8; 
   
  R_ldr = (5.0-v).*(10000./v);
  %i_lux = pow(10.0, ((log10(R_ldr)-b)/m ));
  
  i_lux = 10.^((log10(R_ldr)-b)/m);
%   
%   m2 = -0.363;
%   b2 = log10(20515.0); 
%    
%   R_ldr2 = (5.0-v).*(10000./v);
  %i_lux = pow(10.0, ((log10(R_ldr)-b)/m ));
  
  %i_lux2 = 10.^((log10(R_ldr)-b2)/m2);
  figure();
  plot(u, i_lux);
  
  f = fit(u', i_lux, 'poly1')
  %f2 = fit(u', i_lux2, 'poly1')
  
  hold on;
  
  plot(f);
  
%   figure();
%   
%   plot(u, i_lux2);
%   hold on;
%   plot(f2);
