%% SESSION 3 

rate = [40.00
69.00
94.00
116.00
137.00
156.00
174.00
191.00
206.00
220.00
234.00
247.00
261.00
272.00
282.00
293.00
304.00
312.00
323.00
332.00
338.00
349.00
356.00
366.00
372.00
379.00
386.00
393.00
398.00
406.00
413.00
418.00
425.00
429.00
437.00
441.00
445.00
451.00
456.00
459.00
466.00
470.00
475.00
480.00
483.00
490.00
492.00
494.00
500.00
504.00
505.00
512.00
514.00
519.00
522.00
524.00
531.00
532.00
533.00
539.00
542.00
544.00
548.00
550.00
555.00
557.00
558.00
565.00
565.00
565.00
571.00
572.00
575.00
578.00
579.00
584.00
585.00
585.00
592.00
592.00
591.00
597.00
598.00
601.00
603.00
604.00
609.00
609.00
609.00
616.00
615.00
616.00
620.00
620.00
623.00
625.00
624.00
630.00
630.00
629.00
636.00
634.00
637.00
640.00
639.00
643.00
643.00
642.00
649.00
648.00
646.00
654.00
651.00
655.00
657.00
655.00
660.00
660.00
659.00
665.00
663.00
665.00
670.00
667.00
671.00
672.00
670.00
675.00
674.00
673.00
679.00
677.00
680.00
684.00
680.00
684.00
686.00
683.00
688.00
687.00
688.00
692.00
690.00
693.00
696.00
692.00
697.00
700.00
694.00
700.00
699.00
700.00
704.00
701.00
704.00
708.00
702.00
708.00
710.00
705.00
711.00
709.00
712.00
714.00
711.00
715.00
718.00
712.00
718.00
720.00
718.00
721.00
719.00
722.00
724.00
720.00
725.00
727.00
721.00
727.00
729.00
728.00
730.00
727.00
731.00
733.00
728.00
733.00
735.00
732.00
736.00
737.00
736.00
738.00
735.00
739.00
741.00
736.00
741.00
743.00
741.00
744.00
745.00
744.00
746.00
742.00
747.00
748.00
743.00
749.00
750.00
749.00
751.00
752.00
752.00
753.00
749.00
754.00
755.00
753.00
755.00
757.00
756.00
757.00
758.00
758.00
759.00
755.00
760.00
761.00
760.00
762.00
763.00
763.00
763.00
764.00
764.00
765.00
762.00
766.00
767.00
766.00
767.00
768.00
769.00
769.00
770.00
770.00
770.00
770.00
771.00
772.00
772.00
773.00
774.00
773.00
];

u = (0:1:255);

v = rate * 5 / 1023;

  m = -0.71;
  b = 4.85; 
   
  R_ldr = (5.0-v).*(10000./v);
  %i_lux = pow(10.0, ((log10(R_ldr)-b)/m ));
  
  i_lux = 10.^((log10(R_ldr)-b)/m);
%   
%   m2 = -0.363;
%   b2 = log10(20515.0); 
%    
%   R_ldr2 = (5.0-v).*(10000./v);
  %i_lux = pow(10.0, ((log10(R_ldr)-b)/m ));
  
  %i_lux2 = 10.^((log10(R_ldr)-b2)/m2);
  figure();
  plot(u, i_lux);
  
  f = fit(u', i_lux, 'poly1')
  %f2 = fit(u', i_lux2, 'poly1')
  
  hold on;
  
  plot(f);
  
%   figure();
%   
%   plot(u, i_lux2);
%   hold on;
%   plot(f2);
