%% SESSION 3 

rate = [41.00
61.00
80.00
99.00
117.00
132.00
149.00
164.00
177.00
191.00
204.00
216.00
230.00
239.00
250.00
260.00
272.00
279.00
289.00
296.00
307.00
314.00
322.00
328.00
340.00
344.00
351.00
356.00
363.00
371.00
377.00
381.00
388.00
395.00
400.00
404.00
409.00
415.00
420.00
424.00
429.00
434.00
439.00
442.00
448.00
452.00
456.00
458.00
464.00
468.00
471.00
474.00
479.00
484.00
485.00
488.00
493.00
497.00
499.00
503.00
506.00
510.00
511.00
515.00
518.00
521.00
523.00
527.00
529.00
532.00
533.00
538.00
539.00
543.00
544.00
549.00
549.00
552.00
553.00
558.00
559.00
561.00
562.00
567.00
568.00
571.00
570.00
575.00
577.00
579.00
579.00
584.00
584.00
587.00
586.00
591.00
592.00
594.00
594.00
598.00
599.00
601.00
601.00
606.00
606.00
608.00
607.00
613.00
612.00
614.00
617.00
619.00
619.00
619.00
622.00
625.00
625.00
626.00
628.00
632.00
630.00
632.00
634.00
636.00
636.00
636.00
640.00
642.00
642.00
642.00
645.00
648.00
646.00
647.00
650.00
652.00
651.00
652.00
656.00
657.00
656.00
656.00
660.00
662.00
661.00
660.00
664.00
666.00
664.00
664.00
668.00
670.00
670.00
668.00
672.00
675.00
672.00
673.00
677.00
680.00
677.00
676.00
681.00
682.00
681.00
683.00
684.00
686.00
683.00
687.00
688.00
691.00
687.00
690.00
691.00
693.00
691.00
695.00
695.00
697.00
694.00
697.00
699.00
700.00
697.00
700.00
703.00
703.00
700.00
704.00
705.00
706.00
703.00
706.00
709.00
710.00
705.00
711.00
711.00
713.00
709.00
713.00
715.00
715.00
711.00
716.00
716.00
719.00
715.00
719.00
719.00
721.00
717.00
722.00
722.00
724.00
722.00
723.00
725.00
726.00
725.00
727.00
728.00
729.00
728.00
729.00
730.00
731.00
731.00
731.00
732.00
733.00
732.00
734.00
734.00
735.00
735.00
736.00
737.00
738.00
737.00
739.00
739.00
739.00
740.00
740.00
740.00
741.00
742.00
742.00
742.00
745.00
744.00
745.00
745.00
746.00
];

u = (0:1:255);

v = rate * 5 / 1023;

  m = -0.705;
  b = 4.8155; 
   
  R_ldr = (5.0-v).*(10000./v);
  %i_lux = pow(10.0, ((log10(R_ldr)-b)/m ));
  
  i_lux = 10.^((log10(R_ldr)-b)/m);
%   
%   m2 = -0.363;
%   b2 = log10(20515.0); 
%    
%   R_ldr2 = (5.0-v).*(10000./v);
  %i_lux = pow(10.0, ((log10(R_ldr)-b)/m ));
  
  %i_lux2 = 10.^((log10(R_ldr)-b2)/m2);
  figure();
  plot(u, i_lux);
  
  f = fit(u', i_lux, 'poly1')
  %f2 = fit(u', i_lux2, 'poly1')
  
  hold on;
  
  plot(f);
  
%   figure();
%   
%   plot(u, i_lux2);
%   hold on;
%   plot(f2);
