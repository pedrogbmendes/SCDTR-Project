%% SESSION 3 

rate = [58.00
99.00
133.00
162.00
185.00
208.00
228.00
245.00
262.00
282.00
304.00
317.00
332.00
344.00
356.00
366.00
377.00
387.00
396.00
404.00
412.00
421.00
428.00
437.00
507.00
450.00
455.00
463.00
468.00
474.00
480.00
484.00
490.00
494.00
499.00
569.00
509.00
579.00
517.00
520.00
526.00
529.00
533.00
535.00
538.00
548.00
551.00
556.00
615.00
562.00
628.00
574.00
637.00
579.00
580.00
575.00
585.00
581.00
592.00
593.00
598.00
661.00
599.00
669.00
606.00
673.00
609.00
678.00
614.00
616.00
617.00
612.00
613.00
620.00
694.00
623.00
692.00
633.00
697.00
637.00
695.00
642.00
643.00
645.00
649.00
650.00
653.00
707.00
655.00
708.00
658.00
713.00
661.00
716.00
662.00
721.00
661.00
663.00
663.00
667.00
725.00
670.00
727.00
672.00
730.00
674.00
734.00
676.00
736.00
677.00
739.00
678.00
682.00
740.00
683.00
743.00
685.00
745.00
686.00
747.00
687.00
750.00
688.00
755.00
689.00
756.00
752.00
692.00
754.00
696.00
755.00
701.00
757.00
702.00
759.00
703.00
761.00
702.00
762.00
759.00
707.00
761.00
708.00
762.00
709.00
764.00
709.00
766.00
710.00
767.00
711.00
770.00
768.00
773.00
769.00
717.00
769.00
717.00
775.00
717.00
772.00
718.00
776.00
719.00
778.00
776.00
779.00
775.00
782.00
776.00
723.00
777.00
721.00
774.00
724.00
765.00
717.00
773.00
775.00
776.00
765.00
777.00
774.00
729.00
778.00
730.00
785.00
730.00
786.00
730.00
790.00
788.00
791.00
789.00
793.00
790.00
795.00
792.00
736.00
793.00
736.00
795.00
735.00
796.00
795.00
797.00
796.00
800.00
799.00
799.00
798.00
741.00
797.00
740.00
798.00
740.00
800.00
799.00
801.00
799.00
802.00
801.00
804.00
801.00
806.00
802.00
747.00
803.00
747.00
802.00
803.00
804.00
803.00
804.00
804.00
805.00
804.00
806.00
804.00
809.00
805.00
804.00
805.00
806.00
807.00
806.00
807.00
808.00
808.00
808.00
808.00
809.00
808.00
808.00
808.00
809.00
];

u = (0:1:255);

v = rate * 5 / 1023;

  m = -0.64;
  b = 4.85; 
   
  R_ldr = (5.0-v).*(10000./v);
  %i_lux = pow(10.0, ((log10(R_ldr)-b)/m ));
  
  i_lux = 10.^((log10(R_ldr)-b)/m);
%   
%   m2 = -0.363;
%   b2 = log10(20515.0); 
%    
%   R_ldr2 = (5.0-v).*(10000./v);
  %i_lux = pow(10.0, ((log10(R_ldr)-b)/m ));
  
  %i_lux2 = 10.^((log10(R_ldr)-b2)/m2);
  figure();
  plot(u, i_lux);
  
  f = fit(u', i_lux, 'poly1')
  %f2 = fit(u', i_lux2, 'poly1')
  
  hold on;
  
  plot(f);
  
%   figure();
%   
%   plot(u, i_lux2);
%   hold on;
%   plot(f2);
