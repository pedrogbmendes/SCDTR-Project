s = [3.94
220
3.94
812
3.94
1404
3.94
2044
3.94
2692
3.94
3324
3.95
5684
3.94
18164
3.94
31684
3.95
45204
3.94
58724
3.94
72244
3.94
85764
3.94
99284
3.95
112804
3.94
127364
3.94
141924
3.94
156484
3.95
171044
3.95
185604
3.94
200164
3.94
214724
3.94
229284
3.95
243844
3.94
258404
3.94
272964
3.95
287524
3.94
302084
3.94
316644
3.94
331204
3.95
345764
3.94
360324
3.95
374884
3.94
389444
3.94
404004
3.94
418564
3.94
433124
3.94
447684
3.94
462244
3.94
476804
3.95
491364
3.94
505924
3.94
520484
3.94
535044
3.95
549604
3.94
564164
3.95
578724
3.94
593284
3.94
607844
3.94
622404
3.94
636964
3.94
651524
3.94
666084
3.94
680644
3.95
695204
3.94
709764
3.94
724324
3.94
738884
3.94
753444
3.94
768004
3.94
782564
3.94
797124
3.94
811684
3.95
826244
3.94
840804
3.94
855364
3.94
869924
3.94
884484
3.94
899044
3.94
913604
3.94
928164
3.94
942724
3.94
957284
3.94
971844
3.94
986404
3.94
1000964
3.94
1016564
3.94
1032164
3.94
1047764
3.94
1063364
3.94
1078964
3.94
1094564
3.94
1110164
3.94
1125764
3.94
1141364
3.94
1156964
3.94
1172564
3.94
1188164
3.94
1203764
3.94
1219364
3.94
1234964
3.94
1250564
3.94
1266164
3.94
1281764
3.94
1297364
3.94
1312964
3.94
1328564
3.94
1344164
3.95
1359764
3.95
1375364
3.94
2390988
3.94
2391764
3.93
2392540
3.93
2393316
3.92
2394092
3.90
2401652
3.89
2417252
3.88
2432852
3.88
2448452
3.88
2464052
3.88
2479652
3.88
2495252
3.88
2510852
3.86
2526452
3.89
2542052
3.88
2557652
3.88
2573252
3.88
2588852
3.85
2604452
3.88
2620052
3.88
2635652
3.88
2651252
3.88
2666852
3.88
2682452
3.88
2698052
3.88
2713652
3.88
2729252
3.86
2744860
3.88
2760452
3.88
2776052
3.86
2791652
3.89
2807252
3.88
2822852
3.89
2838452
3.88
2854052
3.85
2869652
3.88
2885252
3.88
2900852
3.88
2916452
3.88
2932052
3.88
2947652
3.88
2963252
3.88
2978852
3.88
2994452
3.88
3010052
3.88
3025652
3.88
3041252
3.85
3056852
3.89
3072452
3.88
3088052
3.88
3103652
3.88
3119252
3.86
3134852
3.88
3150452
3.88
3166052
3.88
3181652
3.88
3197252
3.88
3212852
3.88
3228452
3.88
3244052
3.88
3259652
3.88
3275252
3.88
3290852
3.88
3306452
3.86
3322052
3.88
3337652
3.88
3353252
3.89
3368852
3.88
3384452
3.85
3400052
3.88
3415652
3.88
3431252
3.88
3446852
3.88
3462452
3.88
3478052
3.88
3493652
3.88
3509252
3.88
3524852
3.88
3540452
3.88
3556052
3.88
3571652
3.85
3587252
3.88
3602852
3.88
3618452
3.88
3634052
3.88
3649652
3.85
3665252
3.88
3680852
3.88
3696452
3.88
3712052
3.88
3727652
3.88
3743260
3.88
3758852
3.88
3774452
3.88
3790052
3.88
3805652
3.88
3821252
3.88
3836852
3.86
3852452
3.88
3868052
3.94
4883668
3.90
4884436
3.93
4885220
3.92
4885988
3.91
4886756
3.86
4894332
3.84
4909932
3.83
4925532
3.83
4941132
3.80
4956732
3.83
4972332
3.81
4987932
3.83
5003532
3.83
5019132
3.83
5034732
3.82
5050332
3.80
5065932
3.83
5081532
3.83
5097132
3.82
5112732
3.82
5128332
3.80
5143932
3.83
5159532
3.83
5175132
3.82
5190732
3.83
5206332
3.80
5221932
3.83
5237532
3.81
5253132
3.83
5268732
3.83
5284332
3.82
5299932
3.82
5315532
3.80
5331132
3.83
5346732
3.83
5362332
3.83
5377932
3.82
5393532
3.80
5409132
3.82
5424732
3.83
5440332
3.83
5455932
3.83
5471532
3.83
5487140
3.82
5502732
3.81
5518332
3.83
5533932
3.83
5549532
3.82
5565132
3.83
5580732
3.80
5596332
3.83
5611936
3.83
5627532
3.82
5643132
3.83
5658732
3.80
5674332
3.82
5689932
3.83
5705532
3.82
5721132
3.83
5736732
3.82
5752340
3.82
5767932
3.81
5783532
3.83
5799132
3.83
5814732
3.82
5830332
3.82
5845932
3.80
5861532
3.83
5877132
3.82
5892732
3.83
5908332
3.82
5923932
3.80
5939532
3.82
5955132
3.83
5970732
3.82
5986332
3.83
6001932
3.80
6017532
3.82
6033132
3.81
6048732
3.83
6064332
3.82
6079932
3.82
6095532
3.82
6111132
3.80
6126732
3.83
6142332
3.83
6157932
3.83
6173532
3.83
6189132
3.80
6204732
3.82
6220332
3.83
6235932
3.83
6251532
3.82
6267132
3.80
6282732
3.83
6298332
3.80
6313932
3.83
6329532
3.83
6345132
3.82
6360732
3.94
7376348
3.93
7377116
3.92
7377900
3.91
7378676
3.89
7379444
3.82
7387020
3.78
7402620
3.77
7418220
3.76
7433820
3.73
7449420
3.75
7465020
3.73
7480620
3.75
7496228
3.76
7511820
3.73
7527420
3.75
7543020
3.73
7558620
3.76
7574220
3.75
7589820
3.75
7605420
3.75
7621024
3.73
7636620
3.76
7652220
3.76
7667820
3.76
7683420
3.75
7699020
3.73
7714620
3.75
7730220
3.73
7745820
3.75
7761428
3.75
7777020
3.73
7792620
3.75
7808220
3.73
7823820
3.76
7839420
3.75
7855020
3.75
7870620
3.76
7886220
3.73
7901820
3.76
7917420
3.76
7933020
3.76
7948620
3.75
7964220
3.73
7979820
3.75
7995420
3.73
8011020
3.76
8026620
3.76
8042220
3.73
8057820
3.75
8073420
3.73
8089020
3.76
8104620
3.75
8120220
3.75
8135820
3.75
8151420
3.73
8167020
3.76
8182620
3.76
8198220
3.76
8213820
3.75
8229420
3.73
8245020
3.75
8260620
3.73
8276220
3.76
8291820
3.76
8307420
3.73
8323020
3.75
8338620
3.73
8354220
3.76
8369820
3.76
8385420
3.75
8401020
3.75
8416620
3.73
8432220
3.76
8447820
3.76
8463420
3.75
8479020
3.73
8494628
3.73
8510220
3.75
8525820
3.73
8541420
3.76
8557020
3.76
8572620
3.73
8588220
3.75
8603820
3.73
8619424
3.76
8635020
3.76
8650620
3.75
8666220
3.75
8681820
3.72
8697420
3.75
8713020
3.76
8728620
3.76
8744220
3.73
8759828
3.73
8775420
3.76
8791020
3.73
8806620
3.75
8822220
3.75
8837820
3.73
8853420
3.93
9869036
3.92
9869804
3.88
9870580
3.90
9871356
3.88
9872132
3.77
9879708
3.71
9895308
3.66
9910908
3.68
9926508
3.65
9942108
3.67
9957708
3.65
9973308
3.67
9988908
3.67
10004508
3.67
10021148
3.67
10037788
3.67
10054428
3.65
10071068
3.65
10087708
3.65
10104348
3.65
10120988
3.65
10137628
3.65
10154268
3.64
10170908
3.65
10187548
3.65
10204188
3.64
10220828
3.66
10237468
3.67
10254108
3.67
10270748
3.67
10287388
3.67
10304028
3.67
10320668
3.67
10337308
3.67
10353948
3.67
10370588
3.67
10387228
3.67
10403868
3.67
10420508
3.67
10437148
3.67
10453788
3.67
10470428
3.65
10487068
3.65
10503708
3.65
10520348
3.65
10536988
3.65
10553628
3.64
10570268
3.64
10586908
3.64
10603548
3.64
10620188
3.64
10636828
3.64
10653468
3.67
10670108
3.67
10686748
3.67
10703388
3.67
10720028
3.67
10736668
3.67
10753308
3.67
10769948
3.67
10786588
3.67
10803228
3.67
10819868
3.67
10836508
3.67
10853148
3.67
10869788
3.67
10886428
3.67
10903068
3.65
10919708
3.65
10936348
3.65
10952988
3.65
10969628
3.65
10986268
3.64
11002908
3.64
11019548
3.65
11036188
3.64
11052828
3.64
11069468
3.67
11086108
3.67
11102748
3.67
11119388
3.67
11136028
3.67
11152668
3.67
11169308
3.67
11185948
3.67
11202588
3.67
11219228
3.67
11235868
3.67
11252508
3.67
11269148
3.67
11285788
3.67
11302428
3.67
11319068
3.65
11335708
3.65
11352348
3.65
11368988
3.64
11385628
3.65
11402268
3.64
11418908
3.64
11435548
3.91
12452204
3.92
12453020
3.90
12453844
3.89
12454668
3.84
12455484
3.67
12468084
3.61
12484724
3.59
12501364
3.58
12518004
3.58
12534644
3.58
12551284
3.57
12567924
3.57
12584564
3.57
12601204
3.57
12617844
3.57
12634484
3.54
12651124
3.54
12667764
3.54
12684404
3.54
12701044
3.53
12717684
3.54
12734324
3.54
12750964
3.54
12767604
3.54
12784244
3.54
12800884
3.54
12817524
3.54
12834164
3.54
12850804
3.56
12867444
3.56
12884084
3.56
12900724
3.56
12917364
3.57
12934004
3.56
12950644
3.57
12967284
3.56
12983924
3.57
13000564
3.57
13017204
3.57
13033844
3.57
13050484
3.57
13067124
3.54
13083764
3.54
13100404
3.54
13117044
3.54
13133684
3.54
13150324
3.53
13166964
3.54
13183604
3.54
13200244
3.54
13216884
3.54
13233524
3.54
13250164
3.54
13266804
3.54
13283444
3.56
13300084
3.57
13316724
3.57
13333364
3.57
13350004
3.57
13366644
3.57
13383284
3.56
13399924
3.57
13416564
3.57
13433204
3.56
13449844
3.56
13466484
3.57
13483124
3.54
13499764
3.54
13516404
3.54
13533044
3.54
13549684
3.53
13566324
3.53
13582964
3.54
13599604
3.54
13616244
3.54
13632884
3.54
13649524
3.54
13666164
3.54
13682804
3.54
13699444
3.56
13716084
3.57
13732724
3.57
13749364
3.56
13766004
3.57
13782644
3.57
13799284
3.57
13815924
3.56
13832564
3.57
13849204
3.57
13865844
3.57
13882484
3.57
13899124
3.57
13915764
3.54
13932404
3.54
13949044
3.54
13965684
3.54
13982324
3.53
13998964
3.53
14015604
3.54
14032244
3.90
15048900
3.89
15049716
3.90
15050540
3.87
15051364
3.82
15052180
3.56
15064772
3.46
15081412
3.44
15098052
3.43
15114692
3.42
15131332
3.42
15147972
3.41
15164612
3.43
15181252
3.44
15197892
3.43
15214532
3.43
15231172
3.43
15247812
3.43
15264452
3.43
15281092
3.43
15297732
3.43
15314372
3.43
15331012
3.40
15347652
3.40
15364292
3.40
15380932
3.40
15397572
3.40
15414212
3.40
15430852
3.40
15447492
3.40
15464132
3.40
15480772
3.40
15497412
3.40
15514052
3.40
15530692
3.40
15547332
3.40
15563972
3.40
15580612
3.41
15597252
3.42
15613892
3.43
15630532
3.43
15647172
3.43
15663812
3.43
15680452
3.43
15697092
3.43
15713732
3.43
15730372
3.42
15747012
3.40
15763652
3.40
15780292
3.40
15796932
3.40
15813572
3.40
15830212
3.40
15846852
3.40
15863492
3.40
15880132
3.40
15896772
3.40
15913412
3.40
15930052
3.40
15946692
3.40
15963332
3.40
15979972
3.40
15996612
3.40
16013252
3.42
16029892
3.43
16046532
3.43
16063172
3.43
16079812
3.43
16096452
3.43
16113092
3.43
16129732
3.43
16146372
3.43
16163012
3.43
16179652
3.40
16196292
3.40
16212932
3.40
16229572
3.40
16246212
3.40
16262852
3.40
16279492
3.40
16296132
3.40
16312772
3.40
16329412
3.40
16346052
3.40
16362692
3.40
16379332
3.40
16395972
3.40
16412612
3.40
16429252
3.41
16445892
3.42
16462532
3.43
16479172
3.42
16495812
3.43
16512452
3.43
16529092
3.42
16545732
3.43
16562372
3.43
16579012
3.42
16595652
3.41
16612292
3.40
16628932
3.90
17645588
3.91
17646404
3.89
17647236
3.84
17648052
3.80
17648868
3.47
17661460
3.35
17678092
3.30
17694732
3.27
17711372
3.24
17728020
3.24
17744652
3.23
17761292
3.22
17777932
3.22
17794580
3.22
17811212
3.22
17827852
3.22
17844492
3.21
17861140
3.21
17877772
3.21
17894412
3.21
17911052
3.24
17927700
3.21
17944332
3.21
17960972
3.21
17977612
3.24
17994260
3.21
18010892
3.23
18027532
3.24
18044172
3.21
18060820
3.24
18077452
3.24
18094092
3.24
18110732
3.21
18127380
3.21
18144012
3.21
18160652
3.21
18177292
3.21
18193940
3.21
18210572
3.21
18227212
3.21
18243852
3.21
18260500
3.21
18277132
3.21
18293772
3.21
18310412
3.21
18327060
3.20
18343692
3.21
18360332
3.21
18376972
3.23
18393620
3.21
18410252
3.21
18426892
3.23
18443532
3.21
18460180
3.23
18476812
3.23
18493452
3.23
18510092
3.21
18526740
3.23
18543372
3.23
18560012
3.21
18576652
3.21
18593300
3.20
18609932
3.21
18626572
3.20
18643212
3.21
18659860
3.20
18676492
3.21
18693132
3.21
18709772
3.21
18726420
3.21
18743052
3.20
18759692
3.21
18776332
3.23
18792980
3.21
18809612
3.20
18826252
3.21
18842892
3.24
18859540
3.23
18876172
3.23
18892812
3.23
18909452
3.21
18926100
3.23
18942732
3.24
18959372
3.23
18976012
3.20
18992660
3.20
19009292
3.20
19025932
3.21
19042572
3.20
19059220
3.20
19075852
3.20
19092492
3.21
19109132
3.21
19125780
3.21
19142412
3.20
19159052
3.20
19175692
3.23
19192340
3.21
19208972
3.21
19225612
3.92
20242276
3.88
20243092
3.85
20243908
3.83
20244732
3.79
20245548
3.35
20258140
3.12
20274780
3.04
20291420
3.00
20308060
2.98
20324700
2.99
20341340
2.98
20357980
2.98
20374620
2.97
20391260
2.97
20407900
2.94
20424540
2.93
20441180
2.93
20457820
2.93
20474460
2.93
20491100
2.93
20507740
2.93
20524380
2.93
20541020
2.92
20557660
2.93
20574300
2.92
20590940
2.92
20607580
2.92
20624220
2.92
20640860
2.92
20657500
2.92
20674140
2.92
20690780
2.92
20707420
2.92
20724060
2.92
20740700
2.94
20757340
2.94
20773980
2.95
20790620
2.94
20807260
2.95
20823900
2.92
20840540
2.92
20857180
2.91
20873820
2.92
20890460
2.91
20907100
2.92
20923740
2.92
20940380
2.92
20957020
2.92
20973660
2.91
20990300
2.92
21006940
2.92
21023580
2.92
21040220
2.92
21056860
2.92
21073500
2.92
21090140
2.92
21106780
2.92
21123420
2.92
21140060
2.91
21156700
2.91
21173340
2.94
21189980
2.94
21206620
2.94
21223260
2.94
21239900
2.94
21256540
2.91
21273180
2.91
21289820
2.92
21306460
2.91
21323100
2.92
21339740
2.92
21356380
2.92
21373020
2.92
21389660
2.91
21406300
2.91
21422940
2.92
21439580
2.91
21456220
2.91
21472860
2.91
21489500
2.91
21506140
2.91
21522780
2.91
21539420
2.91
21556060
2.92
21572700
2.91
21589340
2.94
21605980
2.94
21622620
2.94
21639260
2.94
21655900
2.94
21672540
2.91
21689180
2.91
21705820
2.91
21722460
2.91
21739100
2.91
21755740
2.91
21772380
2.91
21789020
2.91
21805660
2.91
21822300
3.90
22838956
3.88
22839772
3.84
22840588
3.81
22841412
3.76
22842236
3.19
22854820
2.84
22871460
2.67
22888100
2.59
22904740
2.54
22921380
2.51
22938020
2.49
22954660
2.48
22971300
2.47
22987940
2.45
23004580
2.45
23021220
2.44
23037860
2.44
23054500
2.44
23071140
2.43
23087780
2.43
23104420
2.42
23121060
2.42
23137700
2.42
23154340
2.44
23170980
2.44
23187620
2.44
23204260
2.42
23220900
2.42
23237540
2.41
23254180
2.41
23270820
2.41
23287460
2.41
23304100
2.41
23320740
2.41
23337380
2.41
23354020
2.41
23370660
2.41
23387300
2.41
23403940
2.41
23420580
2.40
23437220
2.40
23453860
2.40
23470500
2.40
23487140
2.40
23503780
2.40
23520420
2.40
23537060
2.40
23553700
2.40
23570340
2.40
23586980
2.42
23603620
2.43
23620260
2.41
23636900
2.40
23653540
2.40
23670180
2.40
23686820
2.40
23703460
2.40
23720100
2.40
23736740
2.40
23753380
2.40
23770020
2.40
23786660
2.40
23803300
2.40
23819940
2.40
23836580
2.40
23853220
2.40
23869860
2.40
23886500
2.39
23903140
2.40
23919780
2.40
23936420
2.39
23953060
2.40
23969700
2.40
23986340
2.40
24002980
2.42
24019620
2.43
24036260
2.42
24052900
2.40
24069540
2.40
24086180
2.40
24102820
2.40
24119460
2.39
24136100
2.40
24152740
2.40
24169380
2.40
24186020
2.40
24202660
2.40
24219300
2.40
24235940
2.39
24252580
2.39
24269220
2.40
24285860
2.39
24302500
2.39
24319140
2.40
24335780
2.39
24352420
2.40
24369060
2.40
24385700
2.39
24402340
2.40
24418980
];



v = s(1:2:end,:);  % odd matrix

t = s(2:2:end,:);  % even matrix
t = t * 10^(-6);

figure(1);
plot(t,v);


aux = 150 ;
stab = zeros(1, 9);
for i=1:1:9
    stab(i) = mean (v(aux:aux+50)); 
    aux = aux + 100;
end


aux = 101;
y_tau =  zeros(1, 9);
for i=1:1:9
    y_tau(i) = stab(i) + ( v(aux)-stab(i) )*0.37;
    aux = aux + 100;
end

aux = 101;
tau = zeros(1, 9);
for i=1:1:9
    v_aux = v(aux:aux+99);
    t_aux = t(aux:aux+99);
    pt1 = find( v_aux(1:30) >= y_tau(i));
    pt1 = pt1(end);
    m = (v_aux(pt1)-v_aux(pt1+1))/(t_aux(pt1)-t_aux(pt1+1));
    b = v_aux(pt1) - m*(t_aux(pt1));
    tau(i) = (y_tau(i) - b)/m - t_aux(1);
    aux = aux + 100;
end



disp(tau);


pwm = [225 200 175 150 125 100 75 50 25];
figure(2);
plot(pwm, tau,'.');

%f2 = fit (pwm', tau',fittype('power(10,-a*x)'), 'StartPoint',[])
%f2 = fit(pwm', tau',fittype('power(10,(-c*tau))','independent','tau','dependent','height') ,'Exclude', tau < 255 );
pmw_aux = (0:0.1:255);
f2 = 0.0106+0.028*power(10,-0.009*pmw_aux);
hold on;
plot(pmw_aux,f2);


