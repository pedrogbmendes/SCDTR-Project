s = [0.39
216
0.51
792
0.42
1376
0.56
2008
0.48
2648
0.52
3272
0.69
5680
1.64
18160
2.26
31680
2.37
45200
2.46
58720
2.51
72240
2.55
85760
2.57
99280
2.59
112800
2.60
127360
2.61
141920
2.62
156480
2.73
171040
2.64
185600
2.64
200160
2.64
214720
2.65
229280
2.75
243840
2.65
258400
2.65
272960
2.66
287520
2.76
302080
2.66
316640
2.66
331200
2.66
345760
2.67
360320
2.67
374888
2.67
389440
2.67
404000
2.67
418560
2.67
433120
2.77
447680
2.67
462240
2.67
476800
2.68
491360
2.78
505920
2.68
520480
2.68
535040
2.68
549600
2.68
564160
2.78
578720
2.68
593280
2.68
607840
2.68
622400
2.68
636960
3.10
651520
3.10
666080
3.13
680640
3.14
695200
3.26
709760
3.25
724320
3.15
738880
3.16
753440
3.27
768000
3.27
782560
3.16
797120
3.16
811680
3.16
826240
3.17
840808
3.27
855360
3.17
869920
3.17
884480
3.17
899040
3.27
913600
3.27
928160
3.17
942720
3.17
957280
3.27
971840
3.27
986400
3.17
1000960
3.27
1016560
3.17
1032160
3.27
1047760
3.17
1063360
3.17
1078960
3.18
1094560
3.17
1110160
3.28
1125760
3.17
1141360
3.27
1156960
3.17
1172560
3.18
1188160
3.27
1203760
3.17
1219360
3.28
1234960
3.17
1250560
3.17
1266160
3.27
1281760
3.17
1297360
3.28
1312960
3.17
1328560
3.18
1344160
3.18
1359760
3.18
1375360
3.27
1390960
3.36
1406560
3.50
1422160
3.52
1437760
3.42
1453360
3.52
1468960
3.43
1484560
3.53
1500160
3.43
1515760
3.52
1531360
3.53
1546960
3.43
1562560
3.53
1578160
3.43
1593760
3.53
1609360
3.53
1624960
3.53
1640568
3.54
1656160
3.43
1671760
3.53
1687360
3.53
1702960
3.43
1718560
3.53
1734160
3.43
1749760
3.54
1765364
3.44
1780960
3.53
1796560
3.53
1812160
3.43
1827760
3.54
1843360
3.43
1858960
3.53
1874560
3.53
1890160
3.53
1905768
3.54
1921360
3.43
1936960
3.54
1952560
3.53
1968160
3.43
1983760
3.54
1999360
3.43
2014960
3.54
2030560
3.43
2046160
3.53
2061760
3.53
2077360
3.43
2092960
3.54
2108560
3.43
2124160
3.53
2139760
3.53
2155360
3.52
2170960
3.65
2186560
3.57
2202160
3.68
2217760
3.68
2233360
3.68
2248960
3.69
2264560
3.58
2280160
3.69
2295760
3.69
2311360
3.69
2326960
3.69
2342560
3.59
2358160
3.69
2373760
3.69
2389360
3.69
2404960
3.69
2420560
3.68
2436160
3.69
2451760
3.59
2467360
3.69
2482960
3.69
2498560
3.69
2514160
3.68
2529760
3.59
2545360
3.69
2560960
3.69
2576560
3.69
2592160
3.69
2607760
3.59
2623360
3.69
2638968
3.69
2654560
3.69
2670160
3.69
2685760
3.68
2701360
3.69
2716960
3.59
2732560
3.69
2748160
3.69
2763764
3.69
2779360
3.69
2794960
3.59
2810560
3.69
2826160
3.69
2841760
3.69
2857360
3.69
2872960
3.59
2888560
3.69
2904168
3.69
2919760
3.69
2935360
3.69
2950960
3.78
2966560
3.80
2982160
3.80
2997760
3.80
3013360
3.81
3028960
3.80
3044560
3.81
3060160
3.81
3075760
3.81
3091360
3.81
3106960
3.81
3122560
3.80
3138160
3.81
3153760
3.81
3169360
3.80
3184960
3.80
3200560
3.81
3216160
3.80
3231760
3.81
3247360
3.81
3262960
3.81
3278560
3.81
3294160
3.81
3309760
3.81
3325360
3.81
3340960
3.81
3356560
3.81
3372160
3.81
3387760
3.81
3403360
3.81
3418960
3.81
3434560
3.81
3450160
3.81
3465760
3.81
3481360
3.81
3496960
3.81
3512560
3.81
3528160
3.81
3543760
3.80
3559360
3.81
3574960
3.81
3590560
3.81
3606160
3.80
3621760
3.81
3637368
3.81
3652960
3.81
3668560
3.81
3684160
3.81
3699760
3.81
3715360
3.81
3730960
3.72
3746560
3.69
3762164
3.70
3777760
3.60
3793360
3.69
3808960
3.69
3824560
3.69
3840160
3.69
3855760
3.59
3871360
3.69
3886960
3.59
3902568
3.69
3918160
3.69
3933760
3.59
3949360
3.69
3964960
3.69
3980560
3.69
3996160
3.69
4011760
3.68
4027360
3.69
4042960
3.59
4058560
3.69
4074160
3.69
4089760
3.69
4105360
3.69
4120960
3.59
4136560
3.69
4152160
3.69
4167760
3.69
4183360
3.69
4198960
3.59
4214560
3.69
4230160
3.69
4245760
3.69
4261360
3.69
4276960
3.68
4292560
3.69
4308160
3.59
4323760
3.69
4339360
3.69
4354960
3.68
4370560
3.69
4386160
3.59
4401760
3.69
4417360
3.69
4432960
3.69
4448560
3.69
4464160
3.59
4479760
3.69
4495360
3.69
4510960
3.58
4526560
3.55
4542160
3.44
4557760
3.54
4573360
3.44
4588960
3.53
4604560
3.53
4620160
3.54
4635768
3.53
4651360
3.43
4666960
3.54
4682560
3.44
4698160
3.53
4713760
3.53
4729360
3.43
4744960
3.53
4760564
3.43
4776160
3.53
4791760
3.53
4807360
3.43
4822960
3.54
4838560
3.43
4854160
3.53
4869760
3.53
4885360
3.53
4900968
3.53
4916560
3.44
4932160
3.53
4947760
3.43
4963360
3.53
4978960
3.53
4994560
3.43
5010160
3.53
5025760
3.43
5041360
3.53
5056960
3.53
5072560
3.43
5088160
3.53
5103760
3.43
5119360
3.53
5134960
3.53
5150560
3.43
5166160
3.53
5181760
3.43
5197360
3.53
5212960
3.43
5228560
3.53
5244160
3.53
5259760
3.43
5275360
3.53
5290960
3.27
5306560
3.22
5322160
3.20
5337760
3.19
5353360
3.29
5368960
3.18
5384560
3.28
5400160
3.18
5415760
3.18
5431360
3.28
5446960
3.18
5462560
3.28
5478160
3.18
5493760
3.18
5509360
3.28
5524960
3.18
5540560
3.28
5556160
3.18
5571760
3.17
5587360
3.18
5602960
3.18
5618560
3.18
5634168
3.17
5649760
3.28
5665360
3.18
5680960
3.18
5696560
3.27
5712160
3.17
5727760
3.27
5743360
3.18
5758964
3.17
5774560
3.28
5790160
3.18
5805760
3.27
5821360
3.17
5836960
3.18
5852560
3.19
5868160
3.18
5883760
3.18
5899368
3.17
5914960
3.27
5930560
3.18
5946160
3.18
5961760
3.27
5977360
3.18
5992960
3.27
6008560
3.17
6024160
3.18
6039760
3.27
6055360
3.17
6070960
3.01
6086560
2.80
6102160
2.75
6117760
2.73
6133360
2.72
6148960
2.82
6164560
2.71
6180160
2.71
6195760
2.70
6211360
2.70
6226960
2.80
6242560
2.70
6258160
2.79
6273760
2.70
6289360
2.69
6304960
2.69
6320560
2.69
6336160
2.79
6351760
2.69
6367360
2.69
6382960
2.69
6398560
2.69
6414160
2.79
6429760
2.69
6445360
2.69
6460960
2.69
6476560
2.69
6492160
2.79
6507760
2.69
6523360
2.78
6538960
2.69
6554560
2.69
6570160
2.69
6585760
2.69
6601360
2.79
6616960
2.69
6632568
2.69
6648160
2.69
6663760
2.69
6679360
2.79
6694960
2.69
6710560
2.69
6726160
2.69
6741760
2.69
6757364
2.79
6772960
2.69
6788560
2.78
6804160
2.69
6819760
2.69
6835360
];

v = s(1:2:end,:);  % odd matrix

t = s(2:2:end,:);  % even matrix
t = t * 10^(-6);

plot(t,v);



v1 = v(1:50);
v2 = v(51:100);
v3 = v(101:150);
v4 = v(151:200);
v5 = v(201:250);
v6 = v(251:300);
v7 = v(301:350);
v8 = v(351:400);
v9 = v(401:450);

stab1 = mean (v1(30:50));%50
stab2 = mean (v2(30:50));%100
stab3 = mean (v3(30:50));%150
stab4 = mean (v4(30:50));%200
stab5 = mean (v5(30:50));%255
stab6 = mean (v6(30:50));%200
stab7 = mean (v7(30:50));%150
stab8 = mean (v8(30:50));%100
stab9 = mean (v9(30:50));%50

tauy(1) = v1(1) + ( stab1-v1(1) )*0.63; %50
tauy(2) = v2(1) + ( stab2-v2(1) )*0.63; %100
tauy(3) = v3(1) + ( stab3-v3(1) )*0.63; %150
tauy(4) = v4(1) + ( stab4-v4(1) )*0.63; %200
tauy(5) = v5(1) + ( stab5-v5(1) )*0.63; %250
tauy(6) = v6(1) - ( v6(1)-stab6 )*0.37; %200
tauy(7) = v7(1) - ( v7(1)-stab7 )*0.37; %150
tauy(8) = v8(1) - ( v8(1)-stab8 )*0.37; %100
tauy(9) = v9(1) - ( v9(1)-stab9 )*0.37; %50

% f1 = fit (t(1:50),v1,fittype('a-b*exp(-c*x)'), 'StartPoint',[[ones(size(t(1:50))), -exp(-t(1:50))]\v1; 1]);
% %tau = find( v1 <= tauy(1) + 0.1 & v1 >= tauy(1) - 0.1 );
% %plot(f1);
% hold on;
% %plot(t(1:50),aux );
% a = f1.a;
% b = f1.b;
% c = f1.c;
% 
% syms x;
% eqn = a-b*exp(-c*x) == tauy(1);
% tau(1) = double(solve(eqn, x));
% 
% f2 = fit (t(51:100),v2,fittype('a-b*exp(-c*x)'), 'StartPoint',[[ones(size(t(51:100))), -exp(-t(51:100))]\v2; 1]);
% %tau = find( v1 <= tauy(1) + 0.1 & v1 >= tauy(1) - 0.1 );
% %plot(f2);
% hold on;
% %aux(1:50) = tauy(1);
% %plot(t(51, 100),aux );
% a = f2.a;
% b = f2.b;
% c = f2.c;
% 
% syms x;
% eqn = a-b*exp(-c*x) == tauy(2);
% tau(2) = double(solve(eqn, x) -t(50)) ;
% 
% f3 = fit (t(101:150),v3,fittype('a-b*exp(-c*x)'), 'StartPoint',[[ones(size(t(101:150))), -exp(-t(101:150))]\v3; 1]);
% %tau = find( v1 <= tauy(1) + 0.1 & v1 >= tauy(1) - 0.1 );
% %plot(f1);
% hold on;
% %aux(1:50) = tauy(1);
% %plot(t(1:50),aux );
% a = f3.a;
% b = f3.b;
% c = f3.c;
% 
% syms x;
% eqn = a-b*exp(-c*x) == tauy(3);
% tau(3) = double(solve(eqn, x) - t(100));
% 
% f4 = fit (t(151:200),v4,fittype('a-b*exp(-c*x)'), 'StartPoint',[[ones(size(t(151:200))), -exp(-t(151:200))]\v4; 1]);
% %tau = find( v1 <= tauy(1) + 0.1 & v1 >= tauy(1) - 0.1 );
% % plot(f1);
% % hold on;
% % aux(1:50) = tauy(1);
% % plot(t(1:50),aux );
% a = f4.a;
% b = f4.b;
% c = f4.c;
% 
% syms x;
% eqn = a-b*exp(-c*x) == tauy(4);
% tau(4) = double(solve(eqn, x) - t(150));
% 
% f5 = fit (t(201:250),v5,fittype('a-b*exp(-c*x)'), 'StartPoint',[[ones(size(t(201:250))), -exp(-t(201:250))]\v5; 1]);
% %tau = find( v1 <= tauy(1) + 0.1 & v1 >= tauy(1) - 0.1 );
% figure;
% plot(f5);
% hold on;
% % aux(1:50) = tauy(1);
% %plot(t(201:250), v5 );
% a = f5.a;
% b = f5.b;
% c = f5.c;
% 
% syms x;
% eqn = a-b*exp(-c*x) == tauy(5);
% tau(5) = double(solve(eqn, x) - t(200));
% 
% f6 = fit (t(251:300),v6,fittype('a+b*exp(-c*x)'), 'StartPoint',[[ones(size(t(251:300))), -exp(-t(251:300))]\v6; 1]);
% %tau = find( v1 <= tauy(1) + 0.1 & v1 >= tauy(1) - 0.1 );
% % plot(f1);
% % hold on;
% % aux(1:50) = tauy(1);
% % plot(t(1:50),aux );
% a = f6.a;
% b = f6.b;
% c = f6.c;
% 
% syms x;
% eqn = a+b*exp(-c*x) == tauy(6);
% tau(6) = double(solve(eqn, x) - t(250));
% 
% f7 = fit (t(301:350),v7,fittype('a+b*exp(-c*x)'), 'StartPoint',[[ones(size(t(301:350))), -exp(-t(301:350))]\v7; 1]);
% %tau = find( v1 <= tauy(1) + 0.1 & v1 >= tauy(1) - 0.1 );
% % plot(f1);
% % hold on;
% % aux(1:50) = tauy(1);
% % plot(t(1:50),aux );
% a = f7.a;
% b = f7.b;
% c = f7.c;
% 
% syms x;
% eqn = a+b*exp(-c*x) == tauy(7);
% tau(7) = double(solve(eqn, x) - t(300));
% 
% 
% f8 = fit (t(351:400),v8,fittype('a+b*exp(-c*x)'), 'StartPoint',[[ones(size(t(351:400))), -exp(-t(351:400))]\v8; 1]);
% %tau = find( v1 <= tauy(1) + 0.1 & v1 >= tauy(1) - 0.1 );
% % plot(f1);
% % hold on;
% % aux(1:50) = tauy(1);
% % plot(t(1:50),aux );
% a = f8.a;
% b = f8.b;
% c = f8.c;
% 
% syms x;
% eqn = a+b*exp(-c*x) == tauy(8);
% tau(8) = double(solve(eqn, x) - t(350));
% 
% f9 = fit (t(401:450),v9,fittype('a-b*exp(-c*x)'), 'StartPoint',[[ones(size(t(401:450))), -exp(-t(401:450))]\v9; 1]);
% %tau = find( v1 <= tauy(1) + 0.1 & v1 >= tauy(1) - 0.1 );
%  plot(f9);
% hold on;
% % aux(1:50) = tauy(1);
% plot(t(401:450),v9 );
% a = f9.a;
% b = f9.b;
% c = f9.c;
% 
% syms x;
% eqn = a-b*exp(-c*x) == tauy(9);
% tau(9) = double(solve(eqn, x) - t(400));
% 

pt1 = find( v1 <= tauy(1));
pt1 = pt1(end);
m = (v1(pt1+1)-v1(pt1))/(t(pt1+1)-t(pt1));
b = v1(pt1) - m*(t(pt1));
tau(1) = (tauy(1) - b)/m;

pt1 = find( v2 <= tauy(2));
pt1 = pt1(end);
pt1t = pt1 + 50;
m = (v2(pt1+1)-v2(pt1))/(t(pt1t+1)-t(pt1t));
b = v2(pt1) - m*(t(pt1t));
tau(2) = (tauy(2) - b)/m;

pt1 = find( v3 <= tauy(3));
pt1 = pt1(end);
pt1t = pt1 + 100;
m = (v3(pt1+1)-v3(pt1))/(t(pt1+1)-t(pt1));
b = v3(pt1) - m*(t(pt1));
tau(3) = (tauy(3) - b)/m;

pt1 = find( v1 <= tauy(1));
pt1 = pt1(end);
m = (v1(pt1+1)-v1(pt1))/(t(pt1+1)-t(pt1));
b = v1(pt1) - m*(t(pt1));
tau(1) = (tauy(1) - b)/m;

pt1 = find( v1 <= tauy(1));
pt1 = pt1(end);
m = (v1(pt1+1)-v1(pt1))/(t(pt1+1)-t(pt1));
b = v1(pt1) - m*(t(pt1));
tau(1) = (tauy(1) - b)/m;

pt1 = find( v1 <= tauy(1));
pt1 = pt1(end);
m = (v1(pt1+1)-v1(pt1))/(t(pt1+1)-t(pt1));
b = v1(pt1) - m*(t(pt1));
tau(1) = (tauy(1) - b)/m;

pt1 = find( v1 <= tauy(1));
pt1 = pt1(end);
m = (v1(pt1+1)-v1(pt1))/(t(pt1+1)-t(pt1));
b = v1(pt1) - m*(t(pt1));
tau(1) = (tauy(1) - b)/m;

pt1 = find( v1 <= tauy(1));
pt1 = pt1(end);
m = (v1(pt1+1)-v1(pt1))/(t(pt1+1)-t(pt1));
b = v1(pt1) - m*(t(pt1));
tau(1) = (tauy(1) - b)/m;

pt1 = find( v1 <= tauy(1));
pt1 = pt1(end);
m = (v1(pt1+1)-v1(pt1))/(t(pt1+1)-t(pt1));
b = v1(pt1) - m*(t(pt1));
tau(1) = (tauy(1) - b)/m;
