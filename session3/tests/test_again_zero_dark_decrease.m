s = [3.94
220
3.94
812
3.94
1404
3.93
2044
3.94
2692
3.94
3324
3.94
5684
3.94
18164
3.94
31684
3.94
45204
3.94
58724
3.94
72244
3.94
85764
3.94
99284
3.94
112804
3.94
127364
3.94
141924
3.94
156484
3.94
171044
3.94
185604
3.94
200164
3.94
214724
3.94
229284
3.94
243844
3.94
258404
3.94
272964
3.94
287524
3.94
302084
3.94
316644
3.94
331204
3.94
345764
3.94
360324
3.94
374884
3.94
389444
3.94
404004
3.94
418564
3.94
433124
3.94
447684
3.94
462244
3.94
476804
3.94
491364
3.94
505924
3.94
520484
3.94
535044
3.94
549604
3.94
564164
3.94
578724
3.94
593284
3.94
607844
3.94
622404
3.94
636964
3.94
651524
3.94
666084
3.94
680644
3.94
695204
3.94
709764
3.94
724324
3.94
738884
3.94
753444
3.94
768004
3.94
782564
3.94
797124
3.94
811684
3.94
826244
3.94
840804
3.94
855364
3.94
869924
3.94
884484
3.94
899044
3.94
913604
3.94
928164
3.94
942724
3.94
957284
3.94
971844
3.94
986404
3.94
1000964
3.94
1016564
3.94
1032164
3.94
1047764
3.94
1063364
3.94
1078964
3.94
1094564
3.94
1110164
3.94
1125764
3.94
1141364
3.94
1156964
3.94
1172564
3.94
1188164
3.93
1203764
3.94
1219364
3.94
1234964
3.94
1250564
3.94
1266164
3.94
1281764
3.94
1297364
3.94
1312964
3.94
1328564
3.94
1344164
3.94
1359764
3.94
1375364
3.91
1390964
3.89
1406564
3.88
1422164
3.87
1437764
3.88
1453364
3.88
1468964
3.88
1484564
3.88
1500164
3.88
1515764
3.88
1531364
3.85
1546964
3.88
1562564
3.88
1578164
3.88
1593764
3.87
1609364
3.85
1624964
3.88
1640564
3.88
1656164
3.87
1671764
3.88
1687364
3.87
1702964
3.88
1718564
3.88
1734172
3.87
1749764
3.88
1765364
3.87
1780964
3.88
1796564
3.85
1812164
3.87
1827764
3.88
1843364
3.88
1858964
3.88
1874564
3.85
1890164
3.88
1905764
3.88
1921364
3.88
1936964
3.88
1952564
3.87
1968164
3.88
1983764
3.88
1999364
3.88
2014964
3.88
2030564
3.88
2046164
3.88
2061764
3.85
2077364
3.88
2092964
3.88
2108564
3.87
2124164
3.88
2139764
3.85
2155364
3.88
2170964
3.88
2186564
3.88
2202164
3.88
2217764
3.87
2233364
3.88
2248964
3.88
2264564
3.87
2280164
3.88
2295764
3.88
2311364
3.88
2326964
3.85
2342564
3.88
2358164
3.87
2373764
3.88
2389364
3.88
2404964
3.85
2420564
3.88
2436164
3.88
2451764
3.88
2467364
3.88
2482964
3.87
2498564
3.88
2514164
3.88
2529764
3.88
2545364
3.88
2560964
3.87
2576564
3.88
2592164
3.85
2607764
3.88
2623364
3.88
2638964
3.87
2654564
3.88
2670164
3.85
2685764
3.88
2701364
3.88
2716964
3.88
2732572
3.87
2748164
3.87
2763764
3.88
2779364
3.88
2794964
3.88
2810564
3.88
2826164
3.88
2841764
3.88
2857364
3.85
2872964
3.88
2888564
3.88
2904164
3.87
2919764
3.88
2935364
3.85
2950964
3.83
2966564
3.83
2982164
3.82
2997764
3.82
3013364
3.79
3028964
3.82
3044564
3.80
3060164
3.82
3075764
3.82
3091364
3.82
3106964
3.82
3122564
3.80
3138164
3.82
3153764
3.83
3169364
3.82
3184964
3.82
3200564
3.79
3216164
3.82
3231764
3.82
3247364
3.82
3262964
3.82
3278564
3.79
3294164
3.82
3309764
3.80
3325364
3.82
3340964
3.82
3356564
3.82
3372164
3.82
3387764
3.79
3403364
3.82
3418964
3.82
3434564
3.82
3450164
3.82
3465764
3.79
3481364
3.82
3496964
3.82
3512564
3.82
3528164
3.82
3543764
3.79
3559364
3.82
3574964
3.80
3590564
3.82
3606164
3.82
3621764
3.82
3637364
3.82
3652964
3.79
3668564
3.82
3684164
3.82
3699764
3.82
3715364
3.82
3730972
3.79
3746564
3.82
3762164
3.82
3777764
3.82
3793364
3.82
3808964
3.79
3824564
3.82
3840164
3.80
3855764
3.82
3871364
3.82
3886964
3.82
3902564
3.82
3918164
3.79
3933764
3.82
3949364
3.82
3964964
3.82
3980564
3.82
3996164
3.79
4011764
3.82
4027364
3.82
4042964
3.82
4058564
3.82
4074164
3.79
4089764
3.82
4105364
3.80
4120964
3.82
4136564
3.82
4152164
3.82
4167764
3.82
4183364
3.79
4198964
3.82
4214564
3.82
4230164
3.82
4245764
3.82
4261364
3.79
4276964
3.82
4292564
3.82
4308164
3.82
4323764
3.82
4339364
3.79
4354964
3.82
4370564
3.80
4386164
3.82
4401764
3.82
4417364
3.82
4432964
3.82
4448564
3.79
4464164
3.82
4479764
3.82
4495364
3.82
4510964
3.77
4526564
3.73
4542164
3.75
4557764
3.75
4573364
3.75
4588964
3.75
4604564
3.73
4620164
3.75
4635764
3.72
4651364
3.75
4666964
3.75
4682564
3.72
4698164
3.75
4713764
3.75
4729372
3.75
4744964
3.75
4760564
3.75
4776164
3.75
4791764
3.72
4807364
3.75
4822964
3.75
4838564
3.75
4854164
3.75
4869764
3.72
4885364
3.75
4900964
3.72
4916564
3.75
4932164
3.75
4947764
3.73
4963364
3.75
4978964
3.72
4994564
3.75
5010164
3.75
5025764
3.75
5041364
3.75
5056964
3.72
5072564
3.75
5088164
3.75
5103764
3.75
5119364
3.75
5134964
3.72
5150564
3.75
5166164
3.72
5181764
3.75
5197364
3.75
5212964
3.72
5228564
3.75
5244164
3.72
5259764
3.75
5275364
3.75
5290964
3.75
5306564
3.75
5322164
3.72
5337764
3.75
5353364
3.75
5368964
3.75
5384564
3.75
5400164
3.72
5415764
3.75
5431364
3.72
5446964
3.75
5462564
3.75
5478164
3.72
5493764
3.75
5509364
3.72
5524964
3.75
5540564
3.75
5556164
3.75
5571764
3.75
5587364
3.73
5602964
3.75
5618564
3.75
5634164
3.75
5649764
3.75
5665364
3.72
5680964
3.75
5696564
3.72
5712164
3.75
5727772
3.75
5743364
3.72
5758964
3.75
5774564
3.72
5790164
3.75
5805764
3.75
5821364
3.75
5836964
3.75
5852564
3.72
5868164
3.75
5883764
3.75
5899364
3.75
5914964
3.75
5930564
3.72
5946164
3.75
5961764
3.72
5977364
3.75
5992964
3.75
6008564
3.72
6024164
3.75
6039764
3.72
6055364
3.75
6070964
3.69
6086564
3.65
6102164
3.67
6117764
3.64
6133364
3.67
6148964
3.64
6164564
3.66
6180164
3.66
6195764
3.64
6211364
3.66
6226964
3.64
6242564
3.66
6258164
3.66
6273764
3.64
6289364
3.66
6304964
3.64
6320564
3.66
6336164
3.66
6351764
3.64
6367364
3.66
6382964
3.64
6398564
3.66
6414164
3.64
6429764
3.66
6445364
3.66
6460964
3.64
6476564
3.66
6492164
3.64
6507764
3.66
6523364
3.66
6538964
3.64
6554564
3.66
6570164
3.64
6585764
3.66
6601364
3.67
6616964
3.64
6632564
3.66
6648164
3.64
6663764
3.66
6679364
3.64
6694964
3.66
6710564
3.64
6726172
3.64
6741764
3.66
6757364
3.64
6772964
3.66
6788564
3.66
6804164
3.64
6819764
3.66
6835364
3.64
6850964
3.66
6866564
3.66
6882164
3.64
6897764
3.66
6913364
3.64
6928964
3.66
6944564
3.64
6960164
3.66
6975764
3.66
6991364
3.64
7006964
3.66
7022564
3.64
7038164
3.66
7053764
3.66
7069364
3.64
7084964
3.67
7100564
3.64
7116164
3.66
7131764
3.66
7147364
3.64
7162964
3.66
7178564
3.64
7194164
3.66
7209764
3.64
7225364
3.66
7240964
3.66
7256564
3.64
7272164
3.66
7287764
3.64
7303364
3.66
7318964
3.66
7334564
3.64
7350164
3.66
7365764
3.64
7381364
3.66
7396964
3.67
7412564
3.64
7428164
3.66
7443764
3.64
7459364
3.66
7474964
3.64
7490564
3.66
7506164
3.66
7521764
3.64
7537364
3.66
7552964
3.64
7568564
3.66
7584164
3.66
7599764
3.64
7615364
3.66
7630964
3.56
7646564
3.57
7662164
3.54
7677764
3.54
7693364
3.57
7708964
3.56
7724572
3.56
7740164
3.53
7755764
3.53
7771364
3.56
7786964
3.53
7802564
3.56
7818164
3.53
7833764
3.56
7849364
3.56
7864964
3.53
7880564
3.56
7896164
3.53
7911764
3.56
7927364
3.53
7942964
3.53
7958564
3.56
7974164
3.53
7989764
3.56
8005364
3.53
8020964
3.53
8036564
3.56
8052164
3.53
8067764
3.56
8083364
3.53
8098964
3.56
8114564
3.56
8130164
3.53
8145764
3.56
8161364
3.53
8176964
3.56
8192564
3.53
8208164
3.53
8223764
3.56
8239364
3.53
8254964
3.56
8270564
3.53
8286164
3.53
8301764
3.56
8317364
3.53
8332964
3.56
8348564
3.53
8364164
3.56
8379764
3.56
8395364
3.53
8410964
3.56
8426564
3.53
8442164
3.56
8457764
3.53
8473364
3.53
8488964
3.56
8504564
3.53
8520164
3.56
8535764
3.53
8551364
3.53
8566964
3.56
8582564
3.53
8598164
3.56
8613764
3.53
8629364
3.56
8644964
3.56
8660564
3.53
8676164
3.56
8691764
3.53
8707364
3.56
8722972
3.53
8738564
3.53
8754164
3.56
8769764
3.53
8785364
3.56
8800964
3.53
8816564
3.53
8832164
3.56
8847764
3.53
8863364
3.56
8878964
3.53
8894564
3.56
8910164
3.56
8925764
3.53
8941364
3.56
8956964
3.53
8972564
3.56
8988164
3.53
9003764
3.53
9019364
3.56
9034964
3.53
9050564
3.56
9066164
3.53
9081764
3.53
9097364
3.56
9112964
3.53
9128564
3.56
9144164
3.53
9159764
3.56
9175364
3.56
9190964
3.44
9206564
3.44
9222164
3.41
9237764
3.43
9253364
3.40
9268964
3.40
9284564
3.42
9300164
3.40
9315764
3.42
9331364
3.39
9346964
3.39
9362564
3.42
9378164
3.39
9393764
3.42
9409364
3.39
9424964
3.41
9440564
3.40
9456164
3.39
9471764
3.42
9487364
3.39
9502964
3.42
9518564
3.39
9534164
3.39
9549764
3.42
9565364
3.40
9580964
3.42
9596564
3.39
9612164
3.40
9627764
3.42
9643364
3.39
9658964
3.42
9674564
3.39
9690164
3.41
9705764
3.39
9721372
3.39
9736964
3.42
9752564
3.39
9768164
3.42
9783764
3.39
9799364
3.39
9814964
3.42
9830564
3.40
9846164
3.42
9861764
3.39
9877364
3.39
9892964
3.42
9908564
3.40
9924164
3.42
9939764
3.40
9955364
3.41
9970964
3.40
9986564
3.39
10002164
3.39
10018804
3.39
10035444
3.39
10052084
3.39
10068724
3.42
10085364
3.42
10102004
3.42
10118644
3.42
10135284
3.42
10151924
3.42
10168564
3.42
10185204
3.42
10201844
3.42
10218484
3.42
10235124
3.40
10251764
3.39
10268404
3.39
10285044
3.39
10301684
3.39
10318324
3.39
10334964
3.39
10351604
3.39
10368244
3.39
10384884
3.39
10401524
3.39
10418164
3.40
10434804
3.39
10451444
3.39
10468084
3.39
10484724
3.41
10501364
3.42
10518004
3.42
10534644
3.42
10551284
3.42
10567924
3.42
10584564
3.42
10601204
3.42
10617844
3.42
10634484
3.42
10651124
3.40
10667764
3.40
10684404
3.39
10701044
3.39
10717684
3.39
10734324
3.39
10750964
3.39
10767604
3.39
10784244
3.39
10800884
3.26
10817524
3.23
10834164
3.21
10850804
3.21
10867444
3.21
10884084
3.21
10900724
3.20
10917364
3.21
10934004
3.23
10950644
3.23
10967284
3.23
10983924
3.23
11000564
3.23
11017204
3.23
11033844
3.23
11050484
3.23
11067124
3.20
11083764
3.20
11100404
3.20
11117044
3.20
11133684
3.20
11150324
3.20
11166964
3.20
11183604
3.20
11200244
3.20
11216884
3.20
11233524
3.20
11250164
3.20
11266804
3.20
11283444
3.20
11300084
3.20
11316724
3.20
11333364
3.20
11350004
3.20
11366644
3.23
11383284
3.23
11399924
3.23
11416564
3.23
11433204
3.23
11449844
3.23
11466484
3.23
11483124
3.20
11499764
3.20
11516404
3.20
11533044
3.20
11549684
3.20
11566324
3.20
11582964
3.20
11599604
3.20
11616244
3.20
11632884
3.20
11649524
3.20
11666164
3.20
11682804
3.20
11699444
3.20
11716084
3.20
11732724
3.20
11749364
3.20
11766004
3.20
11782644
3.23
11799284
3.23
11815924
3.23
11832564
3.23
11849204
3.23
11865844
3.23
11882484
3.23
11899124
3.23
11915764
3.20
11932404
3.20
11949044
3.20
11965684
3.20
11982324
3.20
11998964
3.20
12015604
3.20
12032244
3.20
12048884
3.20
12065524
3.20
12082164
3.20
12098804
3.20
12115444
3.20
12132084
3.20
12148724
3.20
12165364
3.20
12182004
3.20
12198644
3.20
12215284
3.23
12231924
3.23
12248564
3.23
12265204
3.23
12281844
3.23
12298484
3.23
12315124
3.23
12331764
3.20
12348404
3.20
12365044
3.20
12381684
3.20
12398324
3.20
12414964
3.20
12431604
3.20
12448244
3.20
12464884
3.02
12481524
2.96
12498164
2.94
12514804
2.93
12531444
2.92
12548084
2.92
12564724
2.92
12581364
2.92
12598004
2.91
12614644
2.92
12631284
2.91
12647924
2.93
12664564
2.94
12681204
2.94
12697844
2.94
12714484
2.94
12731124
2.92
12747764
2.92
12764404
2.92
12781044
2.91
12797684
2.91
12814324
2.91
12830964
2.91
12847604
2.91
12864244
2.91
12880884
2.91
12897524
2.91
12914164
2.91
12930804
2.91
12947444
2.91
12964084
2.91
12980724
2.91
12997364
2.91
13014004
2.91
13030644
2.91
13047284
2.91
13063924
2.91
13080564
2.94
13097204
2.94
13113844
2.94
13130484
2.94
13147124
2.94
13163764
2.91
13180404
2.91
13197044
2.91
13213684
2.91
13230324
2.91
13246964
2.91
13263604
2.91
13280244
2.91
13296884
2.91
13313524
2.91
13330164
2.91
13346804
2.91
13363444
2.91
13380084
2.91
13396724
2.91
13413364
2.91
13430004
2.91
13446644
2.91
13463284
2.91
13479924
2.91
13496564
2.93
13513204
2.94
13529844
2.94
13546484
2.94
13563124
2.94
13579764
2.91
13596404
2.91
13613044
2.91
13629684
2.91
13646324
2.91
13662964
2.91
13679604
2.91
13696244
2.91
13712884
2.91
13729524
2.91
13746164
2.91
13762804
2.91
13779444
2.91
13796084
2.91
13812724
2.91
13829364
2.91
13846004
2.91
13862644
2.91
13879284
2.91
13895924
2.91
13912564
2.91
13929204
2.93
13945844
2.94
13962484
2.94
13979124
2.94
13995764
2.94
14012404
2.91
14029044
2.91
14045684
2.91
14062324
2.91
14078964
2.91
14095604
2.91
14112244
2.91
14128884
2.64
14145524
2.51
14162164
2.46
14178804
2.44
14195444
2.43
14212084
2.42
14228724
2.42
14245364
2.41
14262004
2.41
14278644
2.41
14295284
2.41
14311924
2.40
14328564
2.40
14345204
2.40
14361844
2.40
14378484
2.42
14395124
2.42
14411764
2.40
14428404
2.40
14445044
2.40
14461684
2.40
14478324
2.40
14494964
2.40
14511604
2.40
14528244
2.39
14544884
2.40
14561524
2.40
14578164
2.39
14594804
2.39
14611444
2.40
14628084
2.39
14644724
2.39
14661364
2.39
14678004
2.40
14694644
2.39
14711284
2.39
14727924
2.39
14744564
2.39
14761204
2.39
14777844
2.39
14794484
2.41
14811124
2.42
14827764
2.42
14844404
2.40
14861044
2.39
14877684
2.39
14894324
2.39
14910964
2.39
14927604
2.39
14944244
2.39
14960884
2.39
14977524
2.39
14994164
2.39
15010804
2.39
15027444
2.39
15044084
2.39
15060724
2.39
15077364
2.39
15094004
2.39
15110644
2.39
15127284
2.39
15143924
2.39
15160564
2.39
15177204
2.39
15193844
2.39
15210484
2.39
15227124
2.41
15243764
2.42
15260404
2.39
15277044
2.39
15293684
2.39
15310324
2.39
15326964
2.39
15343604
2.39
15360244
2.39
15376884
2.39
15393524
2.39
15410164
2.39
15426804
2.39
15443444
2.39
15460084
2.39
15476724
2.39
15493364
2.39
15510004
2.39
15526644
2.39
15543284
2.39
15559924
2.39
15576564
2.39
15593204
2.39
15609844
2.39
15626484
2.39
15643124
2.42
15659764
2.41
15676404
2.42
15693044
2.39
15709684
2.39
15726324
2.39
15742964
2.39
15759604
2.39
15776244
];

v = s(1:2:end,:);  % odd matrix

t = s(2:2:end,:);  % even matrix
t = t * 10^(-6);

figure(1);
plot(t,v);


aux = 150 ;
stab = zeros(1, 9);
for i=1:1:9
    stab(i) = mean (v(aux:aux+50)); 
    aux = aux + 100;
end


aux = 101;
y_tau =  zeros(1, 9);
for i=1:1:9
    y_tau(i) = stab(i) + ( v(aux)-stab(i) )*0.37;
    aux = aux + 100;
end

aux = 101;
tau = zeros(1, 9);
for i=1:1:9
    v_aux = v(aux:aux+99);
    t_aux = t(aux:aux+99);
    pt1 = find( v_aux(1:5) >= y_tau(i));
    pt1 = pt1(end);
    m = (v_aux(pt1)-v_aux(pt1+1))/(t_aux(pt1)-t_aux(pt1+1));
    b = v_aux(pt1) - m*(t_aux(pt1));
    tau(i) = (y_tau(i) - b)/m - t_aux(1);
    aux = aux + 100;
end


disp(tau);

pwm = [225 200 175 150 125 100 75 50 25];
figure(2);
plot(pwm, tau,'.');

%f2 = fit (pwm', tau',fittype('power(10,-a*x)'), 'StartPoint',[])
%f2 = fit(pwm', tau',fittype('power(10,(-c*tau))','independent','tau','dependent','height') ,'Exclude', tau < 255 );
pmw_aux = (0:0.1:255);
f2 = 0.0106+0.028*power(10,-0.009*pmw_aux);
hold on;
plot(pmw_aux,f2);


