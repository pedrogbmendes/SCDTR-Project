%% SESSION 3 

rate = [54.00
89.00
119.00
145.00
167.00
188.00
206.00
224.00
240.00
252.00
269.00
281.00
293.00
305.00
315.00
326.00
336.00
344.00
354.00
362.00
398.00
378.00
385.00
392.00
400.00
405.00
413.00
419.00
424.00
431.00
436.00
470.00
447.00
451.00
457.00
462.00
465.00
471.00
475.00
507.00
484.00
487.00
520.00
495.00
498.00
503.00
506.00
509.00
513.00
516.00
548.00
523.00
526.00
558.00
533.00
534.00
539.00
541.00
542.00
546.00
549.00
580.00
555.00
556.00
588.00
562.00
563.00
567.00
569.00
599.00
573.00
575.00
606.00
580.00
581.00
613.00
586.00
587.00
590.00
591.00
622.00
595.00
597.00
628.00
601.00
601.00
633.00
606.00
635.00
609.00
610.00
641.00
614.00
615.00
646.00
618.00
619.00
651.00
623.00
653.00
626.00
627.00
658.00
630.00
631.00
662.00
634.00
634.00
666.00
638.00
668.00
640.00
641.00
672.00
643.00
644.00
675.00
647.00
677.00
679.00
650.00
682.00
682.00
654.00
686.00
657.00
658.00
689.00
660.00
691.00
692.00
662.00
694.00
695.00
665.00
697.00
667.00
669.00
700.00
671.00
702.00
704.00
674.00
705.00
706.00
677.00
708.00
678.00
710.00
710.00
680.00
712.00
713.00
683.00
714.00
715.00
685.00
716.00
684.00
716.00
715.00
673.00
703.00
705.00
680.00
709.00
710.00
683.00
712.00
685.00
714.00
714.00
687.00
716.00
716.00
689.00
718.00
718.00
721.00
720.00
693.00
722.00
722.00
696.00
725.00
726.00
698.00
726.00
727.00
727.00
728.00
700.00
731.00
731.00
703.00
732.00
732.00
731.00
732.00
732.00
734.00
734.00
706.00
735.00
735.00
707.00
736.00
736.00
737.00
738.00
738.00
739.00
739.00
711.00
740.00
740.00
713.00
742.00
743.00
743.00
743.00
744.00
745.00
746.00
717.00
747.00
747.00
747.00
748.00
748.00
749.00
749.00
750.00
752.00
751.00
723.00
752.00
752.00
753.00
754.00
753.00
754.00
754.00
755.00
755.00
755.00
755.00
756.00
756.00
757.00
757.00
758.00
758.00
758.00
759.00
760.00
];

u = (0:1:255);

v = rate * 5 / 1023;

  m = -0.67;
  b = 4.8; 
   
  R_ldr = (5.0-v).*(10000./v);
  %i_lux = pow(10.0, ((log10(R_ldr)-b)/m ));
  
  i_lux = 10.^((log10(R_ldr)-b)/m);
%   
%   m2 = -0.363;
%   b2 = log10(20515.0); 
%    
%   R_ldr2 = (5.0-v).*(10000./v);
  %i_lux = pow(10.0, ((log10(R_ldr)-b)/m ));
  
  %i_lux2 = 10.^((log10(R_ldr)-b2)/m2);
  figure();
  plot(u, i_lux);
  
  f = fit(u', i_lux, 'poly1')
  %f2 = fit(u', i_lux2, 'poly1')
  
  hold on;
  
  plot(f);
  
%   figure();
%   
%   plot(u, i_lux2);
%   hold on;
%   plot(f2);
