%% SESSION 3 

rate = [63.00
111.00
150.00
185.00
214.00
241.00
265.00
286.00
306.00
324.00
342.00
354.00
372.00
384.00
399.00
410.00
423.00
432.00
444.00
453.00
463.00
472.00
480.00
489.00
500.00
504.00
508.00
519.00
522.00
532.00
536.00
543.00
548.00
555.00
560.00
565.00
570.00
579.00
580.00
587.00
590.00
590.00
598.00
599.00
606.00
608.00
614.00
616.00
621.00
624.00
633.00
631.00
638.00
638.00
643.00
645.00
643.00
650.00
651.00
656.00
657.00
662.00
663.00
672.00
669.00
676.00
674.00
679.00
679.00
677.00
684.00
682.00
688.00
687.00
692.00
692.00
702.00
697.00
705.00
702.00
707.00
706.00
710.00
709.00
707.00
713.00
711.00
717.00
716.00
726.00
720.00
728.00
724.00
730.00
727.00
732.00
730.00
734.00
733.00
731.00
737.00
735.00
746.00
738.00
747.00
742.00
749.00
745.00
751.00
748.00
752.00
750.00
748.00
754.00
751.00
762.00
754.00
763.00
757.00
764.00
759.00
766.00
762.00
767.00
765.00
769.00
768.00
764.00
776.00
767.00
776.00
770.00
778.00
772.00
779.00
774.00
780.00
777.00
782.00
785.00
783.00
787.00
778.00
788.00
781.00
789.00
783.00
790.00
785.00
792.00
787.00
793.00
796.00
794.00
798.00
789.00
799.00
790.00
800.00
792.00
800.00
794.00
802.00
796.00
803.00
805.00
804.00
807.00
805.00
808.00
799.00
809.00
801.00
809.00
802.00
810.00
805.00
811.00
813.00
813.00
815.00
814.00
815.00
814.00
816.00
808.00
817.00
810.00
818.00
812.00
819.00
820.00
820.00
822.00
821.00
823.00
821.00
823.00
815.00
825.00
816.00
825.00
819.00
826.00
828.00
827.00
828.00
828.00
829.00
828.00
830.00
829.00
830.00
822.00
831.00
825.00
832.00
834.00
833.00
834.00
834.00
835.00
835.00
835.00
835.00
836.00
834.00
837.00
829.00
838.00
838.00
838.00
839.00
839.00
840.00
840.00
840.00
841.00
841.00
841.00
842.00
835.00
843.00
843.00
844.00
844.00
844.00
845.00
845.00
845.00
845.00
846.00
846.00
847.00
847.00
847.00
];

u = (0:1:255);

v = rate * 5 / 1023;

  m = -0.68;
  b = 4.8; 
   
  R_ldr = (5.0-v).*(10000./v);
  %i_lux = pow(10.0, ((log10(R_ldr)-b)/m ));
  
  i_lux = 10.^((log10(R_ldr)-b)/m);
%   
%   m2 = -0.363;
%   b2 = log10(20515.0); 
%    
%   R_ldr2 = (5.0-v).*(10000./v);
  %i_lux = pow(10.0, ((log10(R_ldr)-b)/m ));
  
  %i_lux2 = 10.^((log10(R_ldr)-b2)/m2);
  figure();
  plot(u, i_lux);
  
  f = fit(u', i_lux, 'poly1')
  %f2 = fit(u', i_lux2, 'poly1')
  
  hold on;
  
  plot(f);
  
%   figure();
%   
%   plot(u, i_lux2);
%   hold on;
%   plot(f2);
