%% SESSION 3 

rate = [63.00
86.00
109.00
130.00
148.00
165.00
180.00
195.00
208.00
222.00
233.00
245.00
257.00
266.00
275.00
286.00
294.00
304.00
311.00
319.00
327.00
334.00
342.00
349.00
355.00
363.00
368.00
374.00
380.00
384.00
391.00
395.00
401.00
406.00
411.00
416.00
421.00
425.00
432.00
434.00
439.00
443.00
445.00
451.00
453.00
459.00
461.00
465.00
469.00
473.00
476.00
481.00
482.00
487.00
489.00
493.00
495.00
496.00
501.00
503.00
506.00
508.00
513.00
514.00
520.00
519.00
524.00
525.00
528.00
530.00
532.00
534.00
535.00
539.00
540.00
544.00
545.00
551.00
550.00
555.00
554.00
558.00
558.00
561.00
562.00
562.00
566.00
567.00
570.00
571.00
576.00
575.00
580.00
578.00
583.00
582.00
585.00
585.00
588.00
589.00
589.00
593.00
592.00
598.00
595.00
601.00
599.00
603.00
602.00
606.00
605.00
608.00
608.00
610.00
612.00
611.00
617.00
614.00
619.00
617.00
622.00
620.00
624.00
622.00
626.00
625.00
628.00
628.00
627.00
633.00
630.00
635.00
632.00
637.00
635.00
639.00
637.00
641.00
640.00
643.00
643.00
644.00
648.00
643.00
650.00
646.00
651.00
648.00
653.00
651.00
655.00
653.00
656.00
656.00
658.00
661.00
659.00
662.00
658.00
664.00
660.00
665.00
663.00
667.00
665.00
668.00
668.00
670.00
672.00
671.00
673.00
670.00
675.00
671.00
676.00
673.00
678.00
675.00
679.00
679.00
681.00
683.00
682.00
684.00
682.00
685.00
681.00
687.00
683.00
688.00
685.00
689.00
690.00
691.00
692.00
692.00
693.00
693.00
695.00
693.00
696.00
692.00
697.00
694.00
698.00
699.00
699.00
701.00
701.00
702.00
702.00
703.00
702.00
704.00
701.00
705.00
702.00
706.00
707.00
708.00
709.00
709.00
710.00
710.00
711.00
711.00
712.00
711.00
713.00
709.00
714.00
714.00
715.00
716.00
716.00
717.00
718.00
718.00
719.00
719.00
719.00
720.00
719.00
721.00
721.00
722.00
723.00
723.00
723.00
724.00
724.00
725.00
726.00
726.00
726.00
727.00
];

u = (0:1:255);

v = rate * 5 / 1023;

  m = -0.6443;
  b = 4.75; 
   
  R_ldr = (5.0-v).*(10000./v);
  %i_lux = pow(10.0, ((log10(R_ldr)-b)/m ));
  
  i_lux = 10.^((log10(R_ldr)-b)/m);
%   
%   m2 = -0.363;
%   b2 = log10(20515.0); 
%    
%   R_ldr2 = (5.0-v).*(10000./v);
  %i_lux = pow(10.0, ((log10(R_ldr)-b)/m ));
  
  %i_lux2 = 10.^((log10(R_ldr)-b2)/m2);
  figure();
  plot(u, i_lux);
  
  f = fit(u', i_lux, 'poly1')
  %f2 = fit(u', i_lux2, 'poly1')
  
  hold on;
  
  plot(f);
  
%   figure();
%   
%   plot(u, i_lux2);
%   hold on;
%   plot(f2);
